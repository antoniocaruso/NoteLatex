\documentclass[a4paper]{book} 
\usepackage[T1]{fontenc}
\usepackage[utf8x]{inputenc} 
\usepackage[italian]{babel}
\usepackage{enumitem,graphicx,hyphenat,titlesec,xcolor,url}
\usepackage{amsmath} 
\usepackage{amsthm} 
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{hyperref}
\usepackage[babel=true,final]{microtype} 
\usepackage{boiboites} 
\usepackage[showframe=false,paper=a4paper,margin=1in]{geometry}
\usepackage{wrapfig}
\usepackage{array}
\usepackage{tabularx}

\makeatletter 
\renewcommand\maketitle{
\begin{titlepage} \vspace*{\stretch{1}}
 \begin{center} {\Huge \@title \par}% 
	 \vspace{5em}% 
	 {\LARGE \@author \par}%
	 \vspace{1.5em} {
	 \large \emph{\@date} \par}% 
	 \vspace{3em} \end{center}%
 \vspace*{\stretch{1}} 
\end{titlepage}} 
\makeatother

\usepackage{epigraph} 
\setlength{\epigraphwidth}{0.7\textwidth}
\renewcommand{\epigraphsize}{\small}

\definecolor{titlecolor}{rgb}{0,0,0.5}
\definecolor{shadethmcolor}{HTML}{EDF8FF}
\definecolor{shaderulecolor}{HTML}{45CFFF}

\titleformat{\chapter}[display]
            {\raggedright\normalfont\Large\color{titlecolor}}
			{\chaptertitlename\ \thechapter}{0pt}{\Huge}[\vspace{5pt}\titlerule]
\titleformat{\section}
			{\raggedright\normalfont\Large\bfseries\color{titlecolor}}
			{\thesection}{1ex}{}
\titleformat{\subsection}
			{\raggedright\normalfont\large\bfseries\color{titlecolor}}
			{\thesubsection}{1ex}{}
\titleformat{\paragraph}[runin]
			{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}

\usepackage{etoolbox}
\usepackage{needspace}

\hypersetup{
	pdftitle={Note per il Corso di Programmazione},
	pdfauthor={Antonio Caruso}} 
\hypersetup{ 
	colorlinks=true, 
	linkcolor=black,
	citecolor=black, 
	filecolor=black, 
	urlcolor=black
}

\pagestyle{plain} 
\pagenumbering{alpha} 
\titlespacing*{\chapter}{0pt}{0pt}{40pt}

\hyphenation{rap-pre-sen-ta-zio-ne}

\newboxedtheorem[
	boxcolor = shaderulecolor, % red!50!black, 
	background= shadethmcolor, %blue!5, 
	titlebackground= blue!20,
	titleboxcolor=black]{thm}{Teorema}{thmCounter} 
%\break if fewer than 5\baselineskip is available on page	
\AtBeginEnvironment{thm}{\Needspace{5\baselineskip}} 
	
\newboxedtheorem[
	boxcolor = orange, 
	background=blue!5, 
	titlebackground=blue!20,
	titleboxcolor=black]{defn}{Definizione}{defCounter} 
\newboxedtheorem[
	boxcolor = black, 
	background=blue!5, 
	titlebackground=blue!5,
	titleboxcolor=black]{observe}{Osservazione}{obsCounter} 

%\newboxedtheorem[
%	boxcolor = black, 
%	background=blue!2, 
%	titlebackground=blue!20,
%	titleboxcolor=black,
%	size=0.94\textwidth]{ex}{Esempio}{exCounter} 

\theoremstyle{definition}
\newtheorem{ex}{Esempio}

\usepackage{setspace} 
\setstretch{1.03} 
\setlength{\parskip}{0.2em}

% ---- Front matter ---- 

\title{Note per il Corso di Programmazione}
\author{Antonio Caruso\\[2ex] 
 {\normalsize Dipartimento di Matematica e Fisica '\emph{Ennio De Giorgi}'\\   
              Palazzo Fiorini\\[2ex] 
 \url{mailto://antonio.caruso@unisalento.it}\\
 \url{http://bilbo.unisalento.it/antonio}}} 
\date{\today} 
\pagestyle{plain} 

\clubpenalty=10000 \widowpenalty=10000 \overfullrule=1mm

\newcommand{\nota}[1]{\marginpar[{\raggedleft\small\sffamily #1\\}]{%
 								 {\raggedright\small\sffamily #1\\}}}
\newcommand{\Mod}[1]{\ \text{mod}\ #1}

\includeonly{chapters}

\begin{document}
\hypersetup{pageanchor=false}
\pagenumbering{arabic} 
\frontmatter 
\maketitle
\hypersetup{pageanchor=true} 
\tableofcontents
\pagenumbering{roman} 
\pagestyle{headings} 
\mainmatter

\newgeometry{vmargin=30mm, right=1.9in, marginparsep=3.5mm, footskip=15mm}

\include{chapters}

\end{document}

